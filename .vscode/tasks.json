// filepath: c:\Users\Pawel\Desktop\Samochodowka_studia_mgr\Laboratorium_PSES\Kod\.vscode\tasks.json
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Build and Run UT_Lib_Calc",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-Command",
        "if (Test-Path UT_Lib_Calc.exe) { Remove-Item UT_Lib_Calc.exe -Force }; gcc UT_Lib_Calc.c -o UT_Lib_Calc.exe; if ($?) { .\\UT_Lib_Calc.exe }"
      ],
      "group": {
        "kind": "build",
        "isDefault": false
      },
      "problemMatcher": ["$gcc"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      }
    },

    {
      "label": "Analyze all tests with gcov",
      "type": "shell",
      "command": "del *.gcda,*.gcno,*.gcov; gcc -fprofile-arcs -ftest-coverage -g UT_Lib_Calc.c -o UT_Lib_Calc.exe; ./UT_Lib_Calc.exe; gcov UT_Lib_Calc.c; gcc -fprofile-arcs -ftest-coverage -g UT_Calc_Ab.c -o UT_Calc_Ab.exe; ./UT_Calc_Ab.exe; gcov UT_Calc_Ab.c",
      "group": "test",
      "problemMatcher": []
    },

    {
      "label": "Cppcheck all .c files (Windows)",
      "type": "shell",
      "command": "./CppcheckPortable/App/Cppcheck64/cppcheck.exe --enable=all --inconclusive --std=c99 --language=c --force --quiet --suppress=missingIncludeSystem Calc_Ab.c Lib_Calc.c 2> cppcheck_report.txt",
      "options": {
        "shell": {
          "executable": "powershell.exe"
        }
      },
      "group": {
        "kind": "test",
        "isDefault": false
      },
      "problemMatcher": []
    },

    {
      "label": "Generate Doxygen documentation (PowerShell)",
      "type": "shell",
      "command": "doxygen Doxyfile; if (Test-Path './html/index.html') { $WshShell = New-Object -ComObject WScript.Shell; $shortcut = $WshShell.CreateShortcut('Calc Documentation.lnk'); $shortcut.TargetPath = Join-Path (Get-Location) 'html\\index.html'; $shortcut.Save() }",
      "options": {
        "shell": {
          "executable": "powershell.exe",
          "args": ["-NoProfile", "-Command"]
        }
      },
      "group": {
        "kind": "build",
        "isDefault": false
      },
      "problemMatcher": []
    }
  ]
}